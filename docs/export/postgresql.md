# Postgresql

You can export the data generated by schemas or any type of data to [postgresql](https://www.postgresql.org/) format

## What can you export?

Data can only be exported in two ways:

-  An object with data
-  An array with similar objects (objects must have the same fields and the values of these fields must belong to the same data type)

```js
// ✅ correct
await chaca.export([
   { id: 1, name: 'Amaya' },
   { id: 2, name: 'Jose' },
   { id: 3, name: 'Hector' },
])

// ❌ wrong
await chaca.export([
   { id: 1, name: 'Amaya' },
   { id: 2, name: 'Jose' },
   {
      id: 3,
      name: 'Hector',
      // this field does not exists in other objects
      image: 'https://pixabay.com/get/gced34cca12f5b9cb12e765ebc87a3be51118a7437a87d4636caa28a26ae72d433b2554e104ca79735997400b3fa19634c943d6d63cf5b9e7be93b525d459d86e_1280.jpg',
   },
])

// ❌ wrong
await chaca.export([
   { id: 1, name: 'Amaya' },
   { id: 2, name: 'Jose' },
   // In the other objects of the array, the id field is a number while in this one it is a string, therefore it violates the uniformity of the documents
   { id: 'bac15e95-0cb0-4acb-86b4-b625216c4db9', name: 'Hector' },
])
```

## Example case

```js
const userSchema = chaca.schema({
   username: schemas.internet.userName(),
   image: { type: schemas.image.people(), posibleNull: 50 },
   email: schemas.internet.email(),
})

await userSchema.generateAndExport({
   filaName: 'data',
   format: 'postgresql',
   location: 'folder',
})
```

For example, if we have this schema, we generate 5 documents and export them in **postgresql** format, we will obtain the following result

```sql
CREATE TABLE Data(
	id INTEGER NOT NULL,
	username VARCHAR(255) NOT NULL,
	image VARCHAR(255),
	email VARCHAR(255) NOT NULL,
	PRIMARY KEY (id)
);

INSERT INTO Data VALUES (1, 'Hazel_', NULL, 'victoria623@gmail.com');
INSERT INTO Data VALUES (2, 'Aaron013', 'https://images.unsplash.com/photo-1523464862212-d6631d073194?crop=entropy&cs=tinysrgb&fm=jpg&ixid=MnwzNTM2NjZ8MHwxfHNlYXJjaHw2M3x8cGVvcGxlfGVufDB8fHx8MTY2Njk3MDgzMw&ixlib=rb-4.0.3&q=80', 'dylan.@gmail.com');
INSERT INTO Data VALUES (3, 'Mason220', NULL, 'theodore752@yahoo.com');
INSERT INTO Data VALUES (4, 'Ryan.', 'https://pixabay.com/get/g0178953767bb1280e4cafe638baf623e0b0d4a15984be55d5a456061b113f59fd93b1caae073f5c71162561818571c4bc4f1207fc4adbf824425f3155c223678_1280.jpg', 'ava824@yahoo.com');
INSERT INTO Data VALUES (5, 'Willow.', 'https://images.pexels.com/photos/1851164/pexels-photo-1851164.jpeg', 'easton_@yahoo.com');
```

In the above code you can see several aspects about the generation:

-  The `id` field is automatically generated if no [key field](../fields-type/key) is defined in the schema
-  If the values belonging to a certain field in all documents never have a `null` value, `NOT NULL` will be added to its definition in the table

:::info Possible null fields
If a field has the [possibleNull](../fields-type/field-config#possiblenull) option configured with a value greater than 0 when exporting it in `sql` format, it will be defined as a field that can take a null value
:::

## Transformations

During the generation of the `sql` file there are data types that are not part of the types defined in `sql`, therefore alternatives are taken to be able to represent them.

### Object

When one of the existing fields in the documents is an object with new fields to generate, a new table will be created where all the fields of the object will be declared.

```js
const postSchema = chaca.schema({
   id: chaca.key(chaca.sequence()),
   title: schemas.lorem.words(),
   imageCover: schemas.image.wallpaper(),
   author: chaca.schema({
      name: schemas.person.fullName(),
      age: schemas.dataType.int({ min: 18, max: 90 }),
      email: schemas.internet.email(),
   }),
})
```

```sql
CREATE TABLE Post(
	id INTEGER NOT NULL,
	title VARCHAR(255) NOT NULL,
	imagecover VARCHAR(255) NOT NULL,
	author INTEGER NOT NULL,
	PRIMARY KEY (id),
	FOREIGN KEY (author) REFERENCES Post_author (id)
);

CREATE TABLE Post_author(
	id INTEGER NOT NULL,
	name VARCHAR(255) NOT NULL,
	age INTEGER NOT NULL,
	email VARCHAR(255) NOT NULL,
	PRIMARY KEY (id)
);

INSERT INTO Post VALUES (1, 'exercitation elit proident commodo voluptate', 'https://images.unsplash.com/photo-1444703686981-a3abbc4d4fe3?crop=entropy&cs=tinysrgb&fm=jpg&ixid=MnwzNTM2NjZ8MHwxfHNlYXJjaHw2MHx8d2FsbHBhcGVyfGVufDB8fHx8MTY2Njk3MDc4NA&ixlib=rb-4.0.3&q=80', 1);
INSERT INTO Post VALUES (2, 'irure pariatur velit ex irure', 'https://pixabay.com/get/g43ea9f2c45eb01108557c11a8fdea591e1c7cca452a2be44454c068fb7ca8892e1a36fe6a85e592c5f59ff2f6d3cb540f9d88bda034b99dac16fb6f5503a5677_1280.jpg', 2);
INSERT INTO Post VALUES (3, 'eiusmod ad cupidatat consectetur do', 'https://images.unsplash.com/photo-1510279770292-4b34de9f5c23?crop=entropy&cs=tinysrgb&fm=jpg&ixid=MnwzNTM2NjZ8MHwxfHNlYXJjaHwyOHx8d2FsbHBhcGVyfGVufDB8fHx8MTY2Njk3MDc4MQ&ixlib=rb-4.0.3&q=80', 3);
INSERT INTO Post VALUES (4, 'pariatur dolor quis officia labore', 'https://pixabay.com/get/gc6a147081077919cff568829303a20068c342a966cdec351f543aa26f41c9f26eea2edcf949323df66b4308d170527bc608f9063ffe9ba081af96ce608057707_1280.jpg', 4);
INSERT INTO Post VALUES (5, 'qui deserunt culpa nisi elit', 'https://images.pexels.com/photos/1252890/pexels-photo-1252890.jpeg', 5);
INSERT INTO Post_author VALUES (1, 'Elias Benjamin Knight Anderson', 19, 'harper_@gmail.com');
INSERT INTO Post_author VALUES (2, 'Elijah Cook Anderson', 22, 'samuel_@yahoo.com');
INSERT INTO Post_author VALUES (3, 'Isaiah Anderson Bell', 65, 'nathan546@yahoo.com');
INSERT INTO Post_author VALUES (4, 'Maya Bradley Griffiths', 30, 'ezra653@yahoo.com');
INSERT INTO Post_author VALUES (5, 'Leah Claire Corbyn Ford', 35, 'leo705@hotmail.com');
```

In the case of this schema, the author field is an object with 3 new fields (`email`, `age`, `name`), therefore a new table is created with these properties and their definitions.

### Array
